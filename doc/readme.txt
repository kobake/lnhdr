----------------------------------------------------------------------------
リンク作成シェル拡張 Ver.1.52 for Windows 2000/XP
                                                              2006年 1月15日
----------------------------------------------------------------------------
      1999-2006 Programmed and Copyright by T.Kawasaki, all rights reserved.
----------------------------------------------------------------------------

1, 概要
=========
  Windows 2000/2003/XPで次の機能を実現します。

  ・フォルダに対するシンボリックリンク(正確にはジャンクション)作成機能 (*1)
  ・ファイルに対するハードリンク作成機能 (*1)
  ・ドライブに対するマウントポイント作成機能 (*1)
  ・ジャンクション、マウントポイントに対するアイコンオーバーレイ表示 (*1)
  ・エクスプローラにおけるシンボリックリンクのターゲット表示
  ・エクスプローラにおける詳細なサイズ表示
      標準では大まかなサイズしかわからない・・・
  ・エクスプローラにおけるきっちりした日時(最終更新、作成)表示
      標準では、AM 3:00 が 3:00 と表示されるので、14:00などと並ぶと、表示が
      崩れて美しくない。(大したことではないが・・・)
      ※この点に関しては、コントロールパネルの地域の設定から変更できるとの
        報告があり、試してみたところ、確かに調整が効くことがわかりました。
  ・エクスプローラ上でのフォルダのシンボリックリンクの正しい削除(アンリンク)
      標準では、エクスプローラは中身を消してからフォルダを消そうとしますが、
      シンボリックリンクの場合、単純にリンクを消します。

  次のマニア向け(？)機能も実現します。

  ・エクスプローラ上でハードリンクの数を表示できます(UNIX信者にはうれしい？)。
  ・エクスプローラ上で、ファイル一意識別子(64bit値)を16進で表示します。

  *1) この機能は、NTFS(V5)上でのみ機能します。

  過去の拙作のユーティリティ、「シンボリックリンク作成シェル拡張メニュー」、
  「もっと詳細表示」を統合し、また、これまで懸案事項であった、シンボリック
  リンクの削除に対応しました。

  また、これまで、実際には「ハードリンク」を作っているのに名前がシンボリック
  リンクっていうのはおかしいというツッコミを多くの方からいただいたので、この
  際ということと、もはや、メニュー以外の拡張も加えるということで、名前も、
  「リンク作成シェル拡張」と改名しました。

2, 対応OS
=========
  Windows 2000 Professional SP4
  Windows 2000 Server SP4
  Windows XP Professional SP1/SP2 x86/x64
  Windows XP Home Edition SP1/SP2
  Windows 2003 Server Family SP1/R2 x86/x64

  また、Windows 2000 に関しては、インストールに先立って、Windows Installerの
  バージョンアップが必要になることがあります。

3, アンインストール
=====================
  コントロールパネルの「アプリケーションの追加と削除」から、「リンク作成シェ
  ル拡張 」を探しだし、アンインストールします。

4, 履歴
=====================
Ver.1.52 2006/01/15
  Explorerでネットワークなどを閲覧中にクラッシュするバグを修正(ユーザーからの報告による)。

Ver.1.51 2006/01/10
  Explorerをクラッシュさせる恐れのあったバッファオーバーランを修正(ユーザーからの報告による)。

Ver.1.50 (x64) 2005/12/04
  x64版のビルドをし直した(細かな修正)。

Ver.1.50  2005/11/18
  開発環境をVisual Studio 2005 (English)に変更。
  x64版を試験的にリリース。

Ver.1.49  2005/09/10
  ユーザーの要望により、「ツール」メニューを「ツール(&L)」に変更。

Ver.1.48  2005/08/28
  1.47でgdiplus.dllに依存してしまったために、Windows 2000などでgdiplus.dll
  が導入されていない場合にインストールに失敗していた問題を解決した。
  About ダイアログがTOPMOSTになっていたのを止めた。

Ver.1.47  2005/08/27
  いくつかの機能の追加。

Ver.1.46  2005/08/26
  アイコンオーバーレイ表示の追加。
  権利規約をBSD Licenseに変更。

Ver.1.45  2004/07/01
  未だ、多くの方からバグ報告をいただくので、メンテナンスを再開します。
  他のIColumnProviderとカラムの一覧が干渉することがあった問題を修正した。
  Windows 2003 Serverに対応した。
  英語(US)リソースの追加。

Ver.1.44  2002/12/14
  -

Ver.1.43  2002/12/14
  多くの方からWindows 2000でインストールができないという報告を受けていたが、
  その原因が判明したので修正した。
  対応が遅れて本当にすみませんでした。

Ver.1.42  2002/08/16
  リンクを作成できないファイル・フォルダに関しては極力、「リンクを作成」
  をメニューに表示しないようにした。
  シンボリックリンクに対して、「シンボリックリンク」というタブがプロパティ
  に追加されるようにした。

Ver.1.41  2002/08/02
  リンクを作成・削除しても表示が更新されないことがあったのを修正した。
  リソースの切り替えがうまくいっていなかった問題を修正した。

Ver.1.40  2002/05/05
  インストーラをWindows Installerに変更した。
  内部で利用している文字列をリソースに移動し、英語のリソースを追加した。

Ver.1.32  2001/06/17
  ドライブルートのリンクを作れなかった問題を修正した。
  ドライブルートのリンクをマウントポイントを用いて実現した。

Ver.1.31  2001/03/12
  ファイル一意識別子、ハードリンク数の表示機能を追加。
  コードの一部書き直しを行った。まだ、UNICODE関係がうさんくさいけど。
  内部的には、ファイルのシンボリックリンクも扱えるような構造になったはず。
  http://homepage1.nifty.com/emk/symlink.html を参考にしながら、いろいろ
  やっている最中だが、どうもうまくいかない・・・。

Ver.1.30  2001/03/11
  「リンク作成シェル拡張」としての諸版。
  「シンボリックリンク」は語弊があるので名前を修正。
  リンクを安全に削除する機能を実装した。
  「もっと詳細表示」を機能として統合した。

Ver.1.22(beta)
  一部のフォルダで機能しなかったバグを修正。

Ver.1.21(beta)
  symlink.inf(インストーラ)の不具合修正。
  ドキュメントの不備修正。

Ver.1.20beta
  初版

6, 謝辞
=====================
  このソフトウェアは、http://www.sysinternals.com で公開されている
  Mark Russinovich氏のjunction.cに基づくソースコードを利用しています。
  有益な情報を無料で公開されていることに対して敬意と謝辞の意を表します。

7, その他
=====================
  このソフトウェアに対する権利その他は、rights.txtを参照してください。
  最新版については、http://eside.homeip.net/をご覧ください。


